(cs521) ubuntu@ip-172-31-32-158:~/LHY/cs521_hw3/problem1$ python3 clean_training.py 
no input normalization
/home/ubuntu/LHY/cs521_hw3/problem1/clean_training.py:214: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(device.type == "cuda"))
Start training...
Epoch 1/80:   0%|                                                                                                                     | 0/782 [00:00<?, ?batch/s]/home/ubuntu/LHY/cs521_hw3/problem1/clean_training.py:236: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=(device.type == "cuda")):
Epoch 1/80: 100%|██████████████████████████████████████████████████████████████████████████| 782/782 [00:13<00:00, 59.48batch/s, lr=0.1, loss=1.5707, acc=0.4209]
[Eval] Epoch 1: test_acc=0.3835, test_loss=1.8804
Epoch 2/80: 100%|██████████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.46batch/s, lr=0.1, loss=1.1269, acc=0.5960]
[Eval] Epoch 2: test_acc=0.4740, test_loss=1.6581
Epoch 3/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 67.91batch/s, lr=0.0998, loss=0.9803, acc=0.6507]
[Eval] Epoch 3: test_acc=0.4694, test_loss=1.7035
Epoch 4/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.15batch/s, lr=0.0997, loss=0.8913, acc=0.6874]
[Eval] Epoch 4: test_acc=0.3896, test_loss=2.4706
Epoch 5/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.14batch/s, lr=0.0994, loss=0.8408, acc=0.7026]
[Eval] Epoch 5: test_acc=0.4268, test_loss=2.0914
Epoch 6/80: 100%|████████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.25batch/s, lr=0.099, loss=0.8029, acc=0.7186]
[Eval] Epoch 6: test_acc=0.4727, test_loss=2.0434
Epoch 7/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.65batch/s, lr=0.0986, loss=0.7636, acc=0.7363]
[Eval] Epoch 7: test_acc=0.4165, test_loss=2.3286
Epoch 8/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.26batch/s, lr=0.0981, loss=0.7412, acc=0.7416]
[Eval] Epoch 8: test_acc=0.5409, test_loss=1.5621
Epoch 9/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.24batch/s, lr=0.0976, loss=0.7142, acc=0.7537]
[Eval] Epoch 9: test_acc=0.1860, test_loss=8.5105
Epoch 10/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.24batch/s, lr=0.0969, loss=0.7030, acc=0.7562]
[Eval] Epoch 10: test_acc=0.1408, test_loss=10.0956
Epoch 11/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.28batch/s, lr=0.0962, loss=0.6845, acc=0.7656]
[Eval] Epoch 11: test_acc=0.2908, test_loss=4.6469
Epoch 12/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.86batch/s, lr=0.0955, loss=0.6723, acc=0.7684]
[Eval] Epoch 12: test_acc=0.5878, test_loss=1.7654
Epoch 13/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.57batch/s, lr=0.0946, loss=0.6520, acc=0.7757]
[Eval] Epoch 13: test_acc=0.4199, test_loss=1.9430
Epoch 14/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:20<00:00, 37.93batch/s, lr=0.0937, loss=0.6497, acc=0.7746]
[Eval] Epoch 14: test_acc=0.3965, test_loss=2.8709
Epoch 15/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.55batch/s, lr=0.0927, loss=0.6367, acc=0.7799]
[Eval] Epoch 15: test_acc=0.4360, test_loss=2.4061
Epoch 16/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.57batch/s, lr=0.0917, loss=0.6305, acc=0.7823]
[Eval] Epoch 16: test_acc=0.3238, test_loss=3.5709
Epoch 17/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.22batch/s, lr=0.0905, loss=0.6270, acc=0.7835]
[Eval] Epoch 17: test_acc=0.1755, test_loss=9.0656
Epoch 18/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.58batch/s, lr=0.0894, loss=0.6180, acc=0.7876]
[Eval] Epoch 18: test_acc=0.4636, test_loss=2.6339
Epoch 19/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.99batch/s, lr=0.0881, loss=0.6085, acc=0.7906]
[Eval] Epoch 19: test_acc=0.3257, test_loss=4.2928
Epoch 20/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.54batch/s, lr=0.0868, loss=0.5995, acc=0.7931]
[Eval] Epoch 20: test_acc=0.2677, test_loss=4.2426
Epoch 21/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.42batch/s, lr=0.0855, loss=0.5912, acc=0.7960]
[Eval] Epoch 21: test_acc=0.4029, test_loss=1.9278
Epoch 22/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:44<00:00, 17.60batch/s, lr=0.0841, loss=0.5882, acc=0.7987]
[Eval] Epoch 22: test_acc=0.3235, test_loss=2.9165
Epoch 23/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.56batch/s, lr=0.0826, loss=0.5815, acc=0.8001]
[Eval] Epoch 23: test_acc=0.2856, test_loss=3.8444
Epoch 24/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.72batch/s, lr=0.0811, loss=0.5775, acc=0.8016]
[Eval] Epoch 24: test_acc=0.3494, test_loss=3.1460
Epoch 25/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.29batch/s, lr=0.0796, loss=0.5717, acc=0.8033]
[Eval] Epoch 25: test_acc=0.6159, test_loss=1.3221
Epoch 26/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.43batch/s, lr=0.078, loss=0.5672, acc=0.8066]
[Eval] Epoch 26: test_acc=0.4179, test_loss=2.7512
Epoch 27/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.78batch/s, lr=0.0764, loss=0.5626, acc=0.8059]
[Eval] Epoch 27: test_acc=0.2132, test_loss=5.2446
Epoch 28/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.04batch/s, lr=0.0747, loss=0.5537, acc=0.8104]
[Eval] Epoch 28: test_acc=0.2080, test_loss=6.2364
Epoch 29/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.78batch/s, lr=0.073, loss=0.5426, acc=0.8130]
[Eval] Epoch 29: test_acc=0.5061, test_loss=2.0449
Epoch 30/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.39batch/s, lr=0.0712, loss=0.5440, acc=0.8142]
[Eval] Epoch 30: test_acc=0.4343, test_loss=2.2589
Epoch 31/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.00batch/s, lr=0.0694, loss=0.5322, acc=0.8167]
[Eval] Epoch 31: test_acc=0.5758, test_loss=1.3219
Epoch 32/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.24batch/s, lr=0.0676, loss=0.5289, acc=0.8188]
[Eval] Epoch 32: test_acc=0.3844, test_loss=3.6872
Epoch 33/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.33batch/s, lr=0.0658, loss=0.5225, acc=0.8191]
[Eval] Epoch 33: test_acc=0.4977, test_loss=2.4759
Epoch 34/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.52batch/s, lr=0.0639, loss=0.5172, acc=0.8229]
[Eval] Epoch 34: test_acc=0.2392, test_loss=6.0996
Epoch 35/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.52batch/s, lr=0.0621, loss=0.5120, acc=0.8238]
[Eval] Epoch 35: test_acc=0.5464, test_loss=1.8397
Epoch 36/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.88batch/s, lr=0.0602, loss=0.5021, acc=0.8283]
[Eval] Epoch 36: test_acc=0.3361, test_loss=4.6600
Epoch 37/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.19batch/s, lr=0.0582, loss=0.4959, acc=0.8303]
[Eval] Epoch 37: test_acc=0.4238, test_loss=2.4615
Epoch 38/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.43batch/s, lr=0.0563, loss=0.4853, acc=0.8342]
[Eval] Epoch 38: test_acc=0.1836, test_loss=5.3879
Epoch 39/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.65batch/s, lr=0.0544, loss=0.4749, acc=0.8350]
[Eval] Epoch 39: test_acc=0.5447, test_loss=2.0252
Epoch 40/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.98batch/s, lr=0.0524, loss=0.4737, acc=0.8354]
[Eval] Epoch 40: test_acc=0.2940, test_loss=5.3274
Epoch 41/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.72batch/s, lr=0.0505, loss=0.4568, acc=0.8431]
[Eval] Epoch 41: test_acc=0.5716, test_loss=1.3923
Epoch 42/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.86batch/s, lr=0.0486, loss=0.4516, acc=0.8446]
[Eval] Epoch 42: test_acc=0.3845, test_loss=3.0341
Epoch 43/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.25batch/s, lr=0.0466, loss=0.4509, acc=0.8442]
[Eval] Epoch 43: test_acc=0.1617, test_loss=9.3329
Epoch 44/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:47<00:00, 16.30batch/s, lr=0.0447, loss=0.4389, acc=0.8462]
[Eval] Epoch 44: test_acc=0.1650, test_loss=9.8482
Epoch 45/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.30batch/s, lr=0.0428, loss=0.4229, acc=0.8539]
[Eval] Epoch 45: test_acc=0.2017, test_loss=5.1774
Epoch 46/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.24batch/s, lr=0.0408, loss=0.4223, acc=0.8537]
[Eval] Epoch 46: test_acc=0.4242, test_loss=2.8677
Epoch 47/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.52batch/s, lr=0.0389, loss=0.4069, acc=0.8611]
[Eval] Epoch 47: test_acc=0.4287, test_loss=2.4842
Epoch 48/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.96batch/s, lr=0.0371, loss=0.3970, acc=0.8630]
[Eval] Epoch 48: test_acc=0.4225, test_loss=2.4685
Epoch 49/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.60batch/s, lr=0.0352, loss=0.3894, acc=0.8664]
[Eval] Epoch 49: test_acc=0.4464, test_loss=2.6169
Epoch 50/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.86batch/s, lr=0.0334, loss=0.3729, acc=0.8712]
[Eval] Epoch 50: test_acc=0.5763, test_loss=1.4756
Epoch 51/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.78batch/s, lr=0.0316, loss=0.3641, acc=0.8723]
[Eval] Epoch 51: test_acc=0.4611, test_loss=3.7255
Epoch 52/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.80batch/s, lr=0.0298, loss=0.3540, acc=0.8765]
[Eval] Epoch 52: test_acc=0.6432, test_loss=1.3188
Epoch 53/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.67batch/s, lr=0.028, loss=0.3380, acc=0.8830]
[Eval] Epoch 53: test_acc=0.5439, test_loss=2.3014
Epoch 54/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.80batch/s, lr=0.0263, loss=0.3270, acc=0.8851]
[Eval] Epoch 54: test_acc=0.4784, test_loss=2.3458
Epoch 55/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.51batch/s, lr=0.0246, loss=0.3145, acc=0.8911]
[Eval] Epoch 55: test_acc=0.4875, test_loss=2.5477
Epoch 56/80: 100%|███████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.89batch/s, lr=0.023, loss=0.3009, acc=0.8961]
[Eval] Epoch 56: test_acc=0.3172, test_loss=3.6253
Epoch 57/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.12batch/s, lr=0.0214, loss=0.2858, acc=0.9023]
[Eval] Epoch 57: test_acc=0.3724, test_loss=2.7573
Epoch 58/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.12batch/s, lr=0.0199, loss=0.2704, acc=0.9064]
[Eval] Epoch 58: test_acc=0.4670, test_loss=3.3143
Epoch 59/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.09batch/s, lr=0.0184, loss=0.2550, acc=0.9114]
[Eval] Epoch 59: test_acc=0.5576, test_loss=2.2648
Epoch 60/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.77batch/s, lr=0.0169, loss=0.2407, acc=0.9168]
[Eval] Epoch 60: test_acc=0.5927, test_loss=1.7837
Epoch 61/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.75batch/s, lr=0.0155, loss=0.2197, acc=0.9226]
[Eval] Epoch 61: test_acc=0.6986, test_loss=1.0319
Epoch 62/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.58batch/s, lr=0.0142, loss=0.2054, acc=0.9281]
[Eval] Epoch 62: test_acc=0.5865, test_loss=2.5037
Epoch 63/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.57batch/s, lr=0.0129, loss=0.1902, acc=0.9342]
[Eval] Epoch 63: test_acc=0.7157, test_loss=1.1305
Epoch 64/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.06batch/s, lr=0.0116, loss=0.1662, acc=0.9432]
[Eval] Epoch 64: test_acc=0.6286, test_loss=1.9082
Epoch 65/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:23<00:00, 33.45batch/s, lr=0.0105, loss=0.1458, acc=0.9505]
[Eval] Epoch 65: test_acc=0.4795, test_loss=3.6713
Epoch 66/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.45batch/s, lr=0.00934, loss=0.1339, acc=0.9549]
[Eval] Epoch 66: test_acc=0.4723, test_loss=3.9449
Epoch 67/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.45batch/s, lr=0.00829, loss=0.1176, acc=0.9610]
[Eval] Epoch 67: test_acc=0.6369, test_loss=1.8951
Epoch 68/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.94batch/s, lr=0.00731, loss=0.0958, acc=0.9695]
[Eval] Epoch 68: test_acc=0.5422, test_loss=3.2181
Epoch 69/80: 100%|██████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.23batch/s, lr=0.0064, loss=0.0791, acc=0.9750]
[Eval] Epoch 69: test_acc=0.7257, test_loss=1.0967
Epoch 70/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.06batch/s, lr=0.00555, loss=0.0638, acc=0.9810]
[Eval] Epoch 70: test_acc=0.6546, test_loss=1.8948
Epoch 71/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.97batch/s, lr=0.00477, loss=0.0497, acc=0.9863]
[Eval] Epoch 71: test_acc=0.7392, test_loss=1.1520
Epoch 72/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.97batch/s, lr=0.00406, loss=0.0373, acc=0.9916]
[Eval] Epoch 72: test_acc=0.7084, test_loss=1.5373
Epoch 73/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 69.00batch/s, lr=0.00342, loss=0.0285, acc=0.9944]
[Eval] Epoch 73: test_acc=0.7854, test_loss=0.9406
Epoch 74/80: 100%|█████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 68.63batch/s, lr=0.00286, loss=0.0230, acc=0.9964]
[Eval] Epoch 74: test_acc=0.8110, test_loss=0.8007
Early stop: reached 80%+ accuracy at epoch 74.
Training done. Best test accuracy: 0.8110
Saved best model to: models/clean_trained.pth
(cs521) ubuntu@ip-172-31-32-158:~/LHY/cs521_hw3/problem1$ 